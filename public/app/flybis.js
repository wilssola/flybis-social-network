function writeTokenFCM(e,o){e&&null!=o&&firebase.firestore().collection("users").doc(e.uid).collection("tokens").doc("fcm").get().then((n=>{let s;s=window.isElectron?{electronToken:o}:{webToken:o},n.exists?firebase.firestore().collection("users").doc(e.uid).collection("tokens").doc("fcm").update(s):firebase.firestore().collection("users").doc(e.uid).collection("tokens").doc("fcm").set(s)}))}console.log("flybis.js loaded"),function flutterWeb(){document.addEventListener("keydown",(function(e){"Tab"==e.code&&e.preventDefault()}))}(),function initializeFirebase(){let e,o=!1;firebase.initializeApp({apiKey:"AIzaSyDVPjDNuRCFqq7UmbdNM0EOPqSC_pUgDMc",authDomain:"flybis.firebaseapp.com",databaseURL:"https://flybis.firebaseio.com",projectId:"flybis",storageBucket:"flybis.appspot.com",messagingSenderId:"505131215378",appId:"1:505131215378:web:e06f953492488ed38d06cb",measurementId:"G-FCENZTTDYN"}),firebase.analytics(),firebase.performance(),window.isElectron||(firebase.messaging().usePublicVapidKey("BO3GVEHUf9LIgu0tyOlyDvPX91D3LQOd0JsDh4881BkDwR4uhdIiB8bI9gdpoyynOLGwyNi49tpgUFOIyZPXf78"),firebase.messaging().requestPermission().then((()=>{console.log("FCM Request Success"),firebase.messaging().getToken().then((o=>{o?(window.messagingToken=o,writeTokenFCM(e,window.messagingToken),console.log("FCM: "+o)):console.log("No Instance FCM token available")}))["catch"]((e=>{console.log("An error occurred while retrieving token",e)}))}))["catch"]((e=>{window.messagingToken=null,console.log("FCM Request Error",e)})),firebase.messaging().onTokenRefresh((()=>{firebase.messaging().getToken().then((o=>{o?(window.messagingToken=o,writeTokenFCM(e,window.messagingToken),console.log("FCM Refreshed: "+o)):console.log("No Instance FCM token available")}))["catch"]((e=>{console.log("Unable to retrieve refreshed token",e)}))})),firebase.messaging().onMessage((e=>{console.log("Message received",e),Toastify({avatar:"",text:e.notification.body,duration:5e3,close:!0,gravity:"bottom",position:"left",backgroundColor:"black",stopOnFocus:!0,onClick:()=>{}}).showToast()})));firebase.auth().onAuthStateChanged((function(n){n?(o=!0,e=n,writeTokenFCM(e,window.messagingToken),console.log("UID: "+n.uid)):(o&&(console.log("Logout"),document.location.reload()),e=n)}));const n=indexedDB.open("flybis");n.onsuccess=()=>{firebase.firestore().settings({cacheSizeBytes:firebase.firestore.CACHE_SIZE_UNLIMITED}),firebase.firestore().enablePersistence().then((()=>{console.log("Persistence enabled")}))["catch"]((e=>{"failed-precondition"==e.code?console.error("Persistence work only in one tab",e):"unimplemented"==e.code?console.error("Browser not support persistence",e):console.error("Enable persistence results a error",e)}))},n.onerror=()=>{console.log("Persistence dont enabled")}}();